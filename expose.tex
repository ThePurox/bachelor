\documentclass[a4paper]{article}
\usepackage[a4paper]{geometry}
\usepackage[utf8]{inputenc}
\fontencoding{T1}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage[english]{cleveref}
\usepackage{cleveref}
\usepackage{graphicx}
\renewcommand\vec[1]{\mathbf{#1}}
\usepackage[super]{nth}

\author{Nico Christian Xaver Stuhlmüller}
\title{Expos\'e}


\begin{document}

\maketitle
\tableofcontents
\thispagestyle{empty}
\cleardoublepage

\section{Introduction}
\setcounter{page}{1}
When studying Brownian Particles via simulation one usually uses density-functional-theory (DFT). This however has the disadvantage of only working in equilibrium. When one abstracts DFT to being able to show nonequilibrium dynamics, one gets dynamical-density-functional-theory (DDFT), which assumes the internal forces in the nonequilibrium system are equal to these in an adiabatic system with the same one-body-density. This assumption is only an approximation. In order of getting the real nonequilibrium dynamics one has to use power-functional-theory (PFT) \cite{MS100}.
The problem with PFT is that the central element, the power-functional $ R_t $ is unknown. In previous work Brownian particles were simulated via Brownian dynamics, which has the advantage of being easy to implement, but at the cost of only being able to calculate specific parts of $ R_t $, namely the deterministic ones. Values origin from the entropic behavior state a challenge for BD. For these reasons one can take a different approach, by simulating in configuration space.

With this method one has to solve the Smoluchowski-equation, which is a partial differential equation, describing the dynamics of Brownian particles in configuration space. Where  $\vec{r}^N=\left( \vec{r}_1,\vec{r}_2, \dots,\vec{r}_N \right) $ denotes a configuration, with $\vec{r}_i$ being the coordinate of particle $i$. The Smoluchowski-equation originates from the Fokker-Planck-equation, which is derived from probability-conservation in phase space. \cite{Tobi}. 


\section{Basic Equations}
Smoluchowski's equation:
\begin{equation}\label{eq:smol}
	\frac{\partial \psi}{\partial t} = - \sum_i \nabla_i \cdot \vec{v}_i \psi
\end{equation}
is a PDE, which describes Brownian dynamics in configuration space. $\psi \left( \vec{r}^N ,t \right)$ denotes the probability-density at the configuration $\vec{r}^N$ and time $t$,	$\nabla_i$ denotes the differentiation with respect to the $i$-th particle coordinate $\vec{r}_i$, and $\vec{v}_i$ denotes its velocity. 
In an overdamped system inertia is negligible and therefore the velocity $\vec{v}_i$ of particle $i$ can be written as:
\begin{equation}\label{eq:vel}
	\gamma \vec{v}_i = \vec{F}_i^{\mathrm{tot}} = - \nabla_i U\left( \vec{r}^N \right) + \vec{F}_\mathrm{ext} \left( \vec{r}_i ,t \right) - k_B T \nabla_i \ln \psi \left( \vec{r}^N ,t \right)
\end{equation}
where $\gamma$ denotes the friction coefficient, $U\left( \vec{r}^N \right)$ denotes the total energy originating from particle particle interaction, $\vec{F}_\mathrm{ext}$ denotes the external force, $k_B$ is Boltzmann's constant and $T$ is the Temperature of the System.
Using the velocity and the Dirac-delta one can simply write the one-body current $\vec{J}$ as:
\begin{equation}
	\vec{J}\left( \vec{r}, t \right)=\left \langle \sum_i \vec{v}_i\delta\left( \vec{r}_i(t)-\vec{r}(t) \right) \right \rangle
	\label{eq:current}
\end{equation}
And in similar fashion the one-body density $\rho$ as:
\begin{equation}
	\rho\left( \vec{r}, t \right)=\left \langle \sum_i \delta\left( \vec{r}_i(t)-\vec{r}(t) \right) \right \rangle
	\label{eq:density}
\end{equation}
Where $\left\langle \cdot \right\rangle = \int d \vec{r}^N \cdot \psi $ denotes an average over all configurations.

\section{Variation priciple}
The function 
\begin{equation}
	\hat{R}\left( \vec{r}^N,\vec{v}^N,t \right) = \sum_{i} \left( \frac{ \gamma}{2} \vec{v}_i - \vec{F}_i^{\mathrm{tot}} \right) \cdot \vec{v}_i + \sum_{i} \dot{V}_{\mathrm{ext}} 
	\label{eq:Rhat}
\end{equation}
delivers the total power the system is using at time $t$. %Where $\vec{v}_i=\vec{v}_i\left( \vec{r}^N,t \right)$ denotes a trial velocity.
\cite{MS100} showed that one can construct a functional out of it by averaging over over the distribution function. %They also demonstrated that when derivated with respect to the velocity at a fixed configuration $\psi$ 
After inserting \cref{eq:vel} one gets the power functional
\begin{equation}
	R_t\left[ \psi,\vec{v}^N \right]=- \frac{ \gamma}{2} \int{} d \vec{r}^N \psi\left( \vec{r}^N,t \right) \sum_i \vec{v}_i\left( \vec{r},t \right)^2 + \int{} d \vec{r}^N \psi \sum_i \dot{V}_{\mathrm{ext}}\left( \vec{r}_i,t \right).
	\label{eq:R}
\end{equation}
This is the way we calculate it, as we are simmulating in phase space and have the full $\psi$ and $\vec{v}^N$. Via variation with respect to $\vec{v}^N$ one can show that \cref{eq:R} is the real physical solution. 
The many body expression \cref{eq:R} is useless for more than a hand full of particles, as one can not calculate $\psi(t)$ in any meaningful way if the dimensionality of phase space exceeds 4. Luckily \cite{MS100} showed that %one can reduce the variation with respect to $\vec{v}^N$ to a variation with respect to the one body current $\vec{J}(\vec{r},t)$. This new expression is usefu
there is an eqiuvalent one body functional $\mathcal{R_t}$, which one gets by minimizing $R_t$ with the constraint of resulting in a $\Psi$ that recovers the real one body density and one body current at time $t$. With the help of some tricks one can eliminate the many body minimization which verb the one body variational principle
\begin{equation}
	\frac{\delta \mathcal{R}_t\left[ \rho,\vec{J} \right]}{\delta \vec{J}(\vec{r},t)} = 0
	\label{<+label+>}
\end{equation}<++>

\section{Numerics}
\subsection{Integration of the PDE}
As Smulochowski's equation can only be solved analyticly in the special case without paticle particle interaction and an external force which is constant, one typically solves it numerically on a grid with periodic boundary conditions. The number of gridpoints explodes when rising the particle number. As one has to solve $\mathcal{O}(2n^{d-1})$ linear equation systems in each timestep, where $n$ denotes the spaceial resolution and $d$ denotes the dimensionality of the configuration space. This numerical overhead limits the number of particles one can simulate to four particles in one dimension or two particles in two dimension, with a spacial resolution of 100 gridpoints in each dimension. In order to solve Smulochowski's equation a mix of explicit and implicit schemes gives the best relsults, as it combines the best of both schemes: it is maintains small-scale features and is allways stable \cite{numericalRecepies}.In addition the algorithm is second order accurate in space and time. The implicit part leads to linear equation systems that have to be solved each timestep \cite{Tobi}. Fortuantly they have a tridigonal shape, as the choosen differentiation scheme couples every point on the grid to its two neighbours. The periodic boundary conditions introduce to additional items at the corners of the matrix. Solving such a linear equation system is very fast as it scales with  $\mathcal{O}(2n)$, where $n$ is the spacial resolution \cite{numericalRecepies}. This whole scheme only works in one dimention, so one has to introduce operator splitting, which allows to split the differentiation operators so they can be solved seperatly \cite{numericalRecepies}. This allows to handle the diffusive and the drift part seperatly from each other and the different configuration space dimentions, which can be other particles or spacial dimentions, aswell. Combining everything one has to solve $4n^{d-1}$ linear equation systems each timestep. 
\subsection{Superadiabatic Construction}
An important step in calculating the superadiabatic current $\vec{J}_{ad}$ and the powerfunctional $R_t$, is to do the superadiabatic construction. In it one tries to find an equivalent equibibrium system with the same one body density $\rho$ as given at time $t$ in the dynamic system. In the adiabatic and dynamic system the interaction potential ist the same, so the only thing that we can influence is the external potential $V_{\mathrm{ext,ad}}$. One can not calcutate this potential directly,so we choose an iterative algorithm. As a first guess we take the converged adiabatic potential from the last construction. When no previous construction has happend, we take the potential in which the dynamic system was initialized as the first guess.
After the first guess one can calculate the configuration space this potential would generate. Then we integrate to get the corresponding one body density $\rho_\mathrm{ad} $. Which allows us to iteratively change the adiabatic potential:
\begin{equation}
V_{\mathrm{ext,ad}}^{i+1}(\vec{x})=V_{\mathrm{ext,ad}}^{i}(\vec{x}) + \ln\left( \frac{\rho(\vec{x})}{\rho_{\mathrm{ad}}(\vec{x})} \right) 
\end{equation}
where i denotes the iteration index.
\subsection{Tests}
Many tests were implemented to check the credibility of our results. For the first test we evaluate the conservation of probability by integrating the initial and final cofiguration and comparing the difference, which yields a relative error of $10^{-12}$.
As previously mentioned one can solve Smulochowski's equation analyticly in the case of free diffusion, when comparing the analytic vs. the numerical solution the biggest error happens in the beginning when $\psi$ is changing the most. Here the largest error on any gridpoint is in \nth{4} significant figure. And  the ablolute value of the difference between the analytical and numerical solution integrated over the whole simmulation box is also $10^{-4}$.  

To test self consistency we are looking over the conitinuity equation:
\begin{equation}
	\dot{\rho}=- \nabla \cdot \vec{J},
	\label{eq:coninuity}
\end{equation}
which also results in a relative error $\mathcal{O} (10^{-4})$.  

To check the adiabatic construction we compare the adiabatic probability density $\psi_{\mathrm{ad}}$ to the dynamic one at times when the system is equilibrated. This test results in a relative error $\mathcal{O}(10^{-4})$.  

%
\section{Calculated Variables}
In the introduction it was mentioned that through simulating Smoluchowski's-equation rather than Brownian dynamics, it is possible to calculate new quantities. One of these is the value of the power functional evaluated at its minimum at time $t$:
\begin{equation}
	R^0_t=\left\langle -\frac{\gamma}{2} \sum_i \vec{v}_i^2 \right\rangle
	\label{eq:powerfunctional}
\end{equation}
Furthermore it can be split into its three parts: internal external and entropic, by inserting \cref{eq:vel} once:
\begin{equation}
	R^0_{t,\mathrm{internal}}=\left\langle \frac{1}{2} \sum_i \vec{v}_i \cdot \left(  \nabla_i U\left( \vec{r}^N \right)  \right) \right\rangle
	\label{eq:powerint}
\end{equation}
\begin{equation}
	R^0_{t,\mathrm{external}}=\left\langle -\frac{1}{2} \sum_i \vec{v}_i \cdot  \vec{F}_\mathrm{ext} \left( \vec{r}_i ,t \right)  \right\rangle
	\label{eq:powerext}
\end{equation}
\begin{equation}
	R^0_{t,\mathrm{entropic}}=\left\langle \frac{1}{2} \sum_i \vec{v}_i \cdot \left(   k_B T \nabla_i \ln \psi \left( \vec{r}^N ,t \right) \right) \right\rangle
	\label{eq:powerent}
\end{equation}
It is also possible to calculate the power dissipated at time $t$ by subtraction the  temporal derivative of the intrinsic free energy $\dot{F}_t$, and the power originating from the external potential $X_t=\langle\dot{V}_{\mathrm{ext}}\rho-\vec{F}\cdot \vec{J}\rangle$:
\begin{equation}
	P(t)=R^0_t-\dot{F}_t+X_t
	\label{eq:dissipation}
\end{equation}
Which itself can be split into the dissipation of an ideal gas $P_\mathrm{id}$, and an excess part $P_\mathrm{exc}$ with the ideal part being:
\begin{equation}
	P_\mathrm{id}(t)=\int d \vec{r} \frac{ \gamma}{2} \frac{\left( \vec{J}\left( \vec{r}, t \right) \right)^2}{ \rho\left( \vec{r}, t \right)} 
	\label{eq:dissipationideal}
\end{equation}
Then the excess part, which is the power dissipated through the interaction between particles is:
\begin{equation}
	P_\mathrm{exc}(t)=P(t)- P_\mathrm{id}(t) 
	\label{eq:dissipationexess}
\end{equation}
$P_\mathrm{exc}$ is of large interest as its functional derivative with respect to the one-body current $\vec{J}$ are the superadiabatic Forces. As we only know the numerical value of $P_\mathrm{exc}$, we can not compute the derivative, but we can compute the superadiabatic forces as following:
\begin{equation}
	\vec{F}_\mathrm{superad}=\left \langle -\nabla U \left( \vec{r}^N \right) \right \rangle_\mathrm{dynamic}-\left \langle -\nabla U \left( \vec{r}^N \right) \right \rangle_\mathrm{adiabatic}
	\label{eq:superad}
\end{equation}
The subscrips indicate the system in which the average is computed.

\section{Systems of interest}
The  easiest way to change the behavior of our system is to change the external potential. We have choosen very different potentials to see how $P_\mathrm{exc}$ and $R_t$ change over time in the  potentials.

\subsection{No external potential}
As a reference we are looking at free relaxation, from a density initialized as the equilibrium density formed by a gaussian potential with standard deviation $\frac{5}{3}\sigma$.
\subsection{Bavarian hat}
To get a more interesting system, we initialize the system as above, but change the external potential to what we call a ``Bavarian Hat'' in its resemblace of the well known ``Mexican Hat''. The Bavarian Hat has the following shape:
\begin{equation}
	\mathrm{Bav}(x)=\frac{16 x^2\left( L-x \right)^2}{L^4}
	\label{eq:bavarian}
\end{equation}
\subsection{Sheering}
We looked at sheering 
\begin{equation}
	\vec{F}_\mathrm{ext}=\begin{pmatrix}\frac{1}{2}\sin\left( {2\pi\frac{x}{L}} \right) \\ 0 \end{pmatrix}
	\label{eq:sheer}
\end{equation}

\section{Results}
\begin{figure}
	\centering
	\include{./plots/dissipation}
	\caption{Dissipation}
\end{figure}

\begin{figure}
	\centering
	\include{./plots/dissipationlog}
	\caption{Dissipation}
\end{figure}

\begin{figure}
	\centering
	\include{./plots/freeEnergy}
	\caption{free energy}
\end{figure}

\begin{figure}
	\centering
	\include{./plots/power}
	\caption{power}
\end{figure}

\begin{figure}
	\centering
	\include{./plots/powerlog}
	\caption{power}
\end{figure}

\begin{figure}
	\centering
	\include{./plots/superCurr}
	\caption{superCurr}
\end{figure}
\begin{figure}
	\centering
	\include{./plots/squares}
	\caption{squares}
\end{figure}


\bibliography{expose}
\bibliographystyle{plain}

\end{document}


















\section{Einleitung}
Die Smoluchowski-Gleichung beschreibt überdämpfte Drift-Diffusions-Vorgänge im Konfigurationsraum. Sie ist die Gleichung mit deren Hilfe im Rahmen dieser Bachelorarbeit zentrale Größen der Leistungs-Funktional-Theorie berechnet und interpretiert werden.
Wobei für die Teilchengeschwindigkeit $\vec{v}_i$ aus der Kraftbilanz mit Überdämpfung $m \ddot{\vec{r}}_i \approx 0$ folgt:
wobei $ \vec{r}^N $ eine Konfiguration, $ \psi \left( \vec{r}^N ,t \right) $ die Verteilungsfunktion, $ \nabla_i $ der Gradient bezüglich der $ i$-ten Teilchenposition $ \vec{r}_i $ , $ U\left( \vec{r}^N \right) $ die gesammte Wechselwirkungsenergie, und $ k_B $ die Bolzmann-Konstante und $ T $ die Temperatur beschreibt.
$\left\langle \cdot \right\rangle$ ist der thermodynamische Mittelwert $\int \cdot \psi d \vec{r}^N$.

\section{berechnete Größen}
Die Simmulation auf dem Konfigurationsraum ermöglicht die Berechnung aller systemrelevanten Größen. 
Dies Umfasst unteranderem die Einteilchendichte:
\begin{equation}
	\rho=\left\langle \sum_i \delta\left( \vec{r}_i\left( t \right) \right) \right\rangle
	\label{density}
\end{equation}
und den Einteilchenstrom: 
\begin{equation}\label{curr}
\vec{J}\left( \vec{r},t \right)=\left\langle \sum_{i}\vec{v}_i\delta\left( \vec{r}_i\left( t \right)-\vec{r} \right) \right\rangle
\end{equation}
zerlegt in seine drei Komponenten entropisch, intern und extern:
\begin{equation} \label{currEnt}
	\vec{J}_{\mathrm{ent}}=\left\langle D \sum_i \nabla_i \ln \psi \left( \vec{r}^N \right)\right\rangle \\
\end{equation}
\begin{equation} \label{currInt}
	\vec{J}_{\mathrm{int}}=\left\langle -\frac{1}{\gamma} \sum_i \nabla_i \Phi \left( \vec{r}^N \right)\right\rangle \\
\end{equation}
\begin{equation} \label{currExt}
	\vec{J}_{\mathrm{ext}}=\left\langle -\frac{1}{\gamma} \sum_i \nabla_i V_{ext} \left( \vec{r}_i \right)\right\rangle
\end{equation}
Mit Hilfe dieser beiden Größen kann man die Kontinuitätsgleichung:
\begin{equation}
	\dot{\rho}\left( \vec{r} ,t \right)=- \nabla \cdot \vec{J}\left( \vec{r} ,t \right)
	\label{coninuity}
\end{equation}
testen, welche in der Simmulation im vollen Nichtgleichgewicht eine Abweichung von ca. $10^{-3}$ aufweißt welche im Gleichgewicht auf ca. $10^{-4}$ abfällt.  
Die Ableitungen wurden numerisch mittles zentraler Ableitung durchgeführt.

%	Strom
%	Dichte
%	n-Teilchen-Dichte
%	P(t)
%	P_\mathrm{id}
%	P_\mathrm{exc}
%	R_0(t)
%	Freie Energie
%	V_ad


\end{document}
